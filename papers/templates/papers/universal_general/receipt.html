{% load humanize %}
{% load number_words %}
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Receipt | {{ entry.company.name }}</title>

<style>
@page {
    size: A4;
    margin: 18mm;
}

body {
    font-family: Arial, Helvetica, sans-serif;
    font-size: 12px;
    color: #000;
    margin: 0;
}

.wrapper {
    width: 170mm;
    margin: 0 auto;
}

/* ===== HEADER ===== */
.header {
    width: 100%;
    border-bottom: 3px solid #000;
    margin-bottom: 12px;
}

.header-table {
    width: 100%;
    border-collapse: collapse;
}

.header-table td {
    vertical-align: middle;
}

.company-block h1 {
    margin: 0;
    font-size: 20px;
    text-transform: uppercase;
}

.company-block p {
    margin: 2px 0;
    font-size: 11px;
}

.logo img {
    max-height: 28mm;
    float: right;
}

/* ===== TITLE BAR ===== */
.title-bar {
    margin: 15px 0;
    padding: 8px;
    border: 2px solid #000;
    text-align: center;
    font-size: 16px;
    font-weight: bold;
    letter-spacing: 1px;
    background: #f9f9f9;
}

/* ===== INFO GRID ===== */
.info-grid {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 20px;
}

.info-grid td {
    border: 1px solid #000;
    padding: 8px;
    vertical-align: top;
}

.info-grid .label {
    font-weight: bold;
    width: 25%;
    background: #f2f2f2;
}

/* ===== RECEIPT CONTENT ===== */
.receipt-body {
    border: 1px solid #000;
    padding: 15px;
    line-height: 1.8;
    margin-bottom: 20px;
}

.amount-words {
    text-transform: capitalize;
    font-style: italic;
    font-weight: bold;
    border-bottom: 1px dotted #000;
    padding: 0 5px;
}

.amount-box {
    margin-top: 15px;
    display: inline-block;
    border: 2px solid #000;
    padding: 10px 20px;
    font-size: 18px;
    font-weight: bold;
    background: #f2f2f2;
}

/* ===== PAYMENT METHOD ===== */
.payment-methods {
    margin-top: 10px;
    font-size: 11px;
}

.checkbox {
    display: inline-block;
    width: 12px;
    height: 12px;
    border: 1px solid #000;
    margin-right: 4px;
    vertical-align: middle;
}

/* ===== SIGNATURES ===== */
.signatures {
    width: 100%;
    margin-top: 30mm;
    border-collapse: collapse;
}

.signatures td {
    width: 50%;
    text-align: center;
}

.sig-line {
    margin-top: 15mm;
    border-top: 1px solid #000;
    padding-top: 4px;
    font-size: 11px;
}

/* ===== PDF BUTTON ===== */
.no-print {
    text-align: right;
    margin-bottom: 8px;
}

.no-print a {
    padding: 6px 12px;
    background: #000;
    color: #fff;
    text-decoration: none;
    font-size: 11px;
}

@media print {
    .no-print { display: none; }
}
</style>
</head>

<body>
<div class="wrapper">

<div class="no-print">
    <a href="{% url 'paper_pdf' entry.id 'receipt' %}" target="_blank">
        Download PDF
    </a>
</div>

<!-- HEADER -->
<div class="header">
<table class="header-table">
<tr>
    <td class="company-block">
        <h1>{{ entry.company.name }}</h1>
        <p>{{ entry.company.address }}</p>
        <p>Tel: {{ entry.company.phone }}</p>
        <p>Email: {{ entry.company.email }}</p>
    </td>
    <td class="logo">
        {% if entry.company.logo %}
            {% if is_pdf %}
                <img src="file://{{ entry.company.logo.path }}">
            {% else %}
                <img src="{{ entry.company.logo.url }}">
            {% endif %}
        {% endif %}
    </td>
</tr>
</table>
</div>

<!-- TITLE -->
<div class="title-bar">
    OFFICIAL RECEIPT
</div>

<!-- INFO -->
<table class="info-grid">
<tr>
    <td class="label">Receipt No</td>
    <td>{{ entry.paper_number }}</td>
    <td class="label">Date</td>
    <td>{{ entry.date|date:"d M Y" }}</td>
</tr>
</table>

<!-- MAIN RECEIPT BODY -->
<div class="receipt-body">
    Received with thanks from: <br>
    <strong>{{ entry.client.name }}</strong>
    <br><br>
    
    The sum of: <br>
    <span class="amount-words">
        {{ entry.total|amount_in_words }} Only
    </span>
    <br><br>
    
    Being payment for: <br>
    {{ entry.items.all.0.description }}{% if entry.items.all.count > 1 %} and other items{% endif %} 
    (Ref: {{ entry.reference_number|default:entry.paper_number }})
    <br><br>

    <div class="payment-methods">
        <strong>Payment Method:</strong> &nbsp;
        <span class="checkbox"></span> Cash &nbsp;&nbsp;
        <span class="checkbox"></span> Cheque &nbsp;&nbsp;
        <span class="checkbox"></span> Bank Transfer &nbsp;&nbsp;
        <span class="checkbox"></span> Mobile Money
    </div>

    <div class="amount-box">
        TOTAL: {{ entry.currency_symbol|default:"ZMW" }} {{ entry.total|floatformat:2|intcomma }}
    </div>
</div>

<!-- SIGNATURES -->
<table class="signatures">
<tr>
    <td></td>
    <td>
        <div class="sig-line">Authorized Signature & Stamp</div>
        <div style="font-size: 10px; margin-top: 5px;">Thank you for your business!</div>
    </td>
</tr>
</table>

</div>
</body>
</html>